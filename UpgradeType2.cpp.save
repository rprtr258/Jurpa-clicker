#include "UpgradeType2.h"

UpgradeType2::UpgradeType2() {

}
UpgradeType2::UpgradeType2(int numberUpgrade, int cost, sf::Texture texture) {
    this->upgradeNumber=numberUpgrade;
    this->texture=texture;
    this->cost=cost;
    sprite.setTexture(this->texture);
    sprite.setPosition(16 + this->texture.getSize().x*numberUpgrade,413);
    setPopup();
}

void UpgradeType2::setPopup() {
    std::wostringstream sstream;
    sstream << L"Апгрейд \"Быстрая мушка\"\nCost: " << cost << L"\nУвеличивает количество журп \nза клик на 30% от жпс\nЖурп за клик: " << gameState->getJurpsPerClick();
    popup.setContent(sstream.str());
}

void UpgradeType2::effect(GameState &gameState) {
    gameState.setJurpsPerClick(gameState.getJPS()/10*3 + gameState.getJurpsPerClick());
}

void UpgradeType2::setJPS(int& jps) {
    this->jps = jps;
}

int UpgradeType2::getCost() {
    return cost;
}

void UpgradeType2::setCost(int newCost) {
    this->cost=newCost;
    setPopup();
}

void UpgradeType2::setNum(int num) {
    this->upgradeNumber=num;
    sprite.setTexture(this->texture);
    sprite.setPosition(16 + this->texture.getSize().x*num,413);
}

void UpgradeType2::setTexture(sf::Texture tex) {
    this->texture=texture;
}

sf::Sprite &UpgradeType2::getSprite() {
    return sprite;
}

void UpgradeType2::draw(sf::RenderWindow &window) {
    window.draw(sprite);
    if(Util::isClickedOnSprite(sprite, window)) {
        popup.show();
        popup.draw(window,sf::Mouse::getPosition(window).x,sf::Mouse::getPosition(window).y);
    }
}
